---

## **FASE 2: OPTIMIZACIÓN DE ACCESIBILIDAD Y PRÁCTICAS RECOMENDADAS - OBJETIVO 100/100**

```
FASE 2: ACCESIBILIDAD 100/100 Y PRÁCTICAS RECOMENDADAS 100/100

CONTEXTO ACTUAL:
- Accesibilidad Mobile: 92/100 → META: 100/100
- Accesibilidad Desktop: 88/100 → META: 100/100
- Prácticas recomendadas Mobile: 73/100 → META: 100/100
- Prácticas recomendadas Desktop: 73/100 → META: 100/100

PROBLEMAS IDENTIFICADOS EN PAGESPEED INSIGHTS:

**A. ACCESIBILIDAD - PROBLEMAS DETECTADOS**

1. **NOMBRES Y ETIQUETAS:**
   - ❌ "Los botones no tienen nombres accesibles"
   - Solución requerida: Añadir aria-label o texto visible a todos los botones

2. **CONTRASTE:**
   - ❌ "Los colores de fondo y de primer plano no tienen una relación de contraste adecuada"
   - Ratio mínimo requerido: 4.5:1 para texto normal, 3:1 para texto grande

3. **PRÁCTICAS RECOMENDADAS (Desktop adicional):**
   - ❌ "Las áreas táctiles no tienen un tamaño o un espaciado suficientes"
   - Tamaño mínimo: 48x48px para elementos táctiles

**B. PRÁCTICAS RECOMENDADAS - PROBLEMAS DETECTADOS**

1. **GENERAL:**
   - ❌ "Usa cookies de terceros" - 3-4 cookies encontradas
   - ❌ "Se han registrado problemas en el panel Issues de las herramientas para desarrolladores de Chrome"

2. **EXPERIENCIA DE USUARIO:**
   - ❌ "Muestra imágenes con una relación de aspecto incorrecta"

3. **CONFIANZA Y SEGURIDAD:**
   - ❌ "Asegura que la CSP sea efectiva frente a ataques XSS"
   - ❌ "Usa una política de HSTS sólida"
   - ❌ "Asegúrate de que el aislamiento de orígenes sea adecuado con COOP"
   - ❌ "Mitigar el XSS basado en DOM con Trusted Types"

INSTRUCCIONES DETALLADAS PARA REPLIT AI:

**A. CORREGIR ACCESIBILIDAD - NOMBRES Y ETIQUETAS DE BOTONES**

```
// Buscar TODOS los botones sin texto visible o aria-label y corregirlos

// ❌ INCORRECTO:
<button onClick={handleClick}>
  <IconMenu />
</button>

// ✅ CORRECTO - Opción 1: con aria-label
<button onClick={handleClick} aria-label="Abrir menú de navegación">
  <IconMenu />
</button>

// ✅ CORRECTO - Opción 2: con texto visible + sr-only
<button onClick={handleClick}>
  <IconMenu />
  <span className="sr-only">Abrir menú</span>
</button>

// ✅ CORRECTO - Opción 3: con title Y aria-label
<button onClick={handleClick} aria-label="Cerrar modal" title="Cerrar">
  <IconClose />
</button>
```

**ACCIONES ESPECÍFICAS:**

1. **Header/Navigation:**
```
// Botón de hamburguesa
<button 
  onClick={toggleMenu}
  aria-label="Abrir menú principal"
  aria-expanded={isMenuOpen}
  aria-controls="main-navigation"
>
  <MenuIcon />
</button>

// Botón de idioma
<button 
  onClick={handleLanguageChange}
  aria-label="Cambiar idioma a inglés"
>
  <FlagIcon />
</button>

// Botón de búsqueda
<button 
  type="submit"
  aria-label="Buscar en el sitio"
>
  <SearchIcon />
</button>
```

2. **Botones de redes sociales:**
```
<a 
  href="https://wa.me/584226361047"
  target="_blank"
  rel="noopener noreferrer"
  aria-label="Contactar por WhatsApp"
>
  <WhatsAppIcon />
</a>

<a 
  href="tel:+584226361047"
  aria-label="Llamar al +58 422-6361047"
>
  <PhoneIcon />
</a>
```

3. **Controles de carrusel/slider:**
```
<button 
  onClick={nextSlide}
  aria-label="Siguiente imagen"
  aria-controls="carousel-slides"
>
  <ChevronRight />
</button>

<button 
  onClick={prevSlide}
  aria-label="Imagen anterior"
  aria-controls="carousel-slides"
>
  <ChevronLeft />
</button>
```

4. **Botones de cerrar modales:**
```
<button 
  onClick={closeModal}
  aria-label="Cerrar ventana de cotización"
>
  <XIcon />
</button>
```

**B. CORREGIR CONTRASTE DE COLORES**

```
/* Auditar TODOS los textos y asegurar ratio 4.5:1 mínimo */

/* ❌ INCORRECTO: Texto gris claro sobre blanco */
.text-secondary {
  color: #999999; /* Ratio: 2.8:1 - FALLA */
  background: #ffffff;
}

/* ✅ CORRECTO: Usar gris más oscuro */
.text-secondary {
  color: #666666; /* Ratio: 5.7:1 - PASA */
  background: #ffffff;
}

/* ❌ INCORRECTO: Verde claro sobre blanco */
.cta-button {
  color: #66ff66; /* Ratio: 1.5:1 - FALLA */
  background: #ffffff;
}

/* ✅ CORRECTO: Verde más oscuro */
.cta-button {
  color: #228B22; /* Ratio: 4.8:1 - PASA */
  background: #ffffff;
}
```

**HERRAMIENTA DE VERIFICACIÓN:**

Usar WebAIM Contrast Checker o implementar verificación automática:

```
// utils/contrastChecker.ts
function getLuminance(r: number, g: number, b: number): number {
  const [rs, gs, bs] = [r, g, b].map(c => {
    c = c / 255;
    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
  });
  return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
}

function getContrastRatio(color1: string, color2: string): number {
  // Implementar cálculo de ratio según WCAG 2.1
  // Retornar ratio, debe ser >= 4.5:1 para AA
}
```

**COLORES SEGUROS PARA TEXTO:**

```
/* Variables CSS con contraste verificado */
:root {
  /* Texto sobre fondo blanco (#ffffff) */
  --text-primary: #1a1a1a;    /* Ratio: 16.1:1 ✅ */
  --text-secondary: #4a4a4a;  /* Ratio: 9.7:1 ✅ */
  --text-tertiary: #666666;   /* Ratio: 5.7:1 ✅ */
  
  /* Texto sobre fondo oscuro (#1a1a1a) */
  --text-on-dark: #ffffff;    /* Ratio: 16.1:1 ✅ */
  --text-on-dark-secondary: #e0e0e0; /* Ratio: 12.6:1 ✅ */
  
  /* Colores de marca con contraste adecuado */
  --green-primary: #047857;   /* Ratio: 4.6:1 sobre blanco ✅ */
  --green-dark: #065f46;      /* Ratio: 6.4:1 sobre blanco ✅ */
  
  /* Enlaces */
  --link-color: #0066cc;      /* Ratio: 7.3:1 sobre blanco ✅ */
  --link-visited: #551a8b;    /* Ratio: 8.6:1 sobre blanco ✅ */
}
```

**C. TAMAÑOS DE ÁREAS TÁCTILES (Mobile)**

```
/* Todos los elementos interactivos deben tener mínimo 48x48px */

/* ❌ INCORRECTO: Botón muy pequeño */
.icon-button {
  width: 32px;
  height: 32px;
  padding: 0;
}

/* ✅ CORRECTO: Tamaño táctil adecuado */
.icon-button {
  min-width: 48px;
  min-height: 48px;
  padding: 12px;
  /* O usar padding para alcanzar 48px si el contenido es pequeño */
}

/* ✅ Espaciado entre botones */
.button-group button {
  margin: 0 8px; /* Mínimo 8px de separación */
}
```

**APLICAR A:**

1. **Botones de navegación móvil**
2. **Iconos sociales**
3. **Controles de formulario (checkboxes, radios)**
4. **Links pequeños en footer**
5. **Controles de carrusel**

```
// Componente de botón accesible
interface AccessibleButtonProps {
  children: React.ReactNode;
  onClick: () => void;
  ariaLabel: string;
  variant?: 'primary' | 'secondary' | 'icon';
}

const AccessibleButton: React.FC<AccessibleButtonProps> = ({
  children,
  onClick,
  ariaLabel,
  variant = 'primary'
}) => {
  return (
    <button
      onClick={onClick}
      aria-label={ariaLabel}
      className={`
        min-w-[48px] min-h-[48px]
        inline-flex items-center justify-center
        ${variant === 'icon' ? 'p-3' : 'px-6 py-3'}
        touch-manipulation
      `}
    >
      {children}
    </button>
  );
};
```

**D. PRÁCTICAS RECOMENDADAS - COOKIES DE TERCEROS**

```
// Auditar y eliminar cookies de terceros innecesarias

// 1. Verificar en server/index.ts o middleware
app.use((req, res, next) => {
  // No establecer cookies de terceros
  res.setHeader('Set-Cookie', 'sessionId=xxx; SameSite=Strict; Secure; HttpOnly');
  next();
});

// 2. Si usas Google Analytics, migrar a GA4 con consentimiento
// 3. Eliminar cualquier script de terceros que establezca cookies sin consentimiento

// 4. Implementar banner de cookies GDPR-compliant
const CookieConsent = () => {
  const [showBanner, setShowBanner] = useState(true);
  
  const acceptCookies = () => {
    localStorage.setItem('cookieConsent', 'accepted');
    setShowBanner(false);
    // Solo entonces cargar scripts de terceros
    loadAnalytics();
  };
  
  return showBanner ? (
    <div className="cookie-banner" role="alert" aria-live="polite">
      <p>Usamos cookies esenciales para el funcionamiento del sitio.</p>
      <button onClick={acceptCookies} aria-label="Aceptar cookies">
        Aceptar
      </button>
    </div>
  ) : null;
};
```

**E. RELACIÓN DE ASPECTO DE IMÁGENES**

```
// ❌ INCORRECTO: Sin aspect-ratio definido
<img src="image.jpg" alt="..." />

// ✅ CORRECTO: Con width, height y aspect-ratio
<img 
  src="image.jpg"
  width="800"
  height="600"
  alt="Descripción"
  style={{ aspectRatio: '4/3' }}
/>

// ✅ CORRECTO: Con CSS
.image-container img {
  width: 100%;
  height: auto;
  aspect-ratio: 16 / 9;
  object-fit: cover;
}
```

**APLICAR A TODAS LAS IMÁGENES:**

1. **Hero images**: aspect-ratio 16:9 o 21:9
2. **Imágenes de blog**: aspect-ratio 16:9
3. **Logos de equipos**: aspect-ratio 4:3
4. **Thumbnails**: aspect-ratio 1:1
5. **Galería de proyectos**: aspect-ratio 16:9

**F. SEGURIDAD - CONTENT SECURITY POLICY (CSP)**

```
// server/index.ts - Implementar CSP headers

app.use((req, res, next) => {
  res.setHeader(
    'Content-Security-Policy',
    [
      "default-src 'self'",
      "script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net",
      "style-src 'self' 'unsafe-inline' https://fonts.googleapis.com",
      "font-src 'self' https://fonts.gstatic.com",
      "img-src 'self' data: https: blob:",
      "connect-src 'self' https://api.openrouter.ai https://generativelanguage.googleapis.com",
      "frame-ancestors 'none'",
      "base-uri 'self'",
      "form-action 'self'",
    ].join('; ')
  );
  next();
});
```

**NOTA:** Ajustar según los dominios externos que realmente uses. Remover 'unsafe-inline' y 'unsafe-eval' gradualmente.

**G. HSTS (HTTP Strict Transport Security)**

```
// server/index.ts

app.use((req, res, next) => {
  // HSTS: Forzar HTTPS por 1 año
  res.setHeader(
    'Strict-Transport-Security',
    'max-age=31536000; includeSubDomains; preload'
  );
  next();
});

// Asegurarse que el servidor esté configurado para HTTPS
// En producción (Replit), verificar que está usando HTTPS automáticamente
```

**H. COOP (Cross-Origin-Opener-Policy)**

```
// server/index.ts

app.use((req, res, next) => {
  res.setHeader('Cross-Origin-Opener-Policy', 'same-origin');
  res.setHeader('Cross-Origin-Embedder-Policy', 'require-corp');
  res.setHeader('Cross-Origin-Resource-Policy', 'same-origin');
  next();
});
```

**ADVERTENCIA:** COOP puede romper funcionalidad si abres ventanas de terceros. Probar cuidados